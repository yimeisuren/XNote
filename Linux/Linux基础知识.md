# 主机规划与磁盘分区

<u>内容</u>

+ 磁盘分区
+ 文件系统
+ Linux操作较频繁的目录



<u>在Linux中, 一切皆文件</u>

<center>常见设备及其在Linux系统中的文件名</center>

| 设备              | 设备在Linux内的文件名                                        |
| ----------------- | ------------------------------------------------------------ |
| SCSI/SATA/USB硬盘 | `/dev/sd[a-p]`                                               |
| VirtI/O界面       | `/dev/vd[a-p]`                                               |
| 软盘              | `/dev/fd[0-7]`                                               |
| 打印机            | `/dev/lp[0-2]`<br />`/dev/usb/lp[0-15]`                      |
| 鼠标              | `/dev/input/mouse[0-15]`<br />`/dev/psaux`<br />`/dev/mouse` |
| CDROM<br />DVDROM | `/dev/scd[0-1]`<br />`/dev/sr[0-1]`<br />`/dev/cdrom`        |
| 磁带机            | `/dev/ht0`<br />`/dev/st0`<br />`/dev/tape`                  |

## 磁盘分区

以Windows系统的观点来看, 将一块磁盘分为C,D,E三个盘区, 则C,D,E就是<u>分区(partition)</u>.

> 例题: 如果你的PC上面有两个SATA磁盘以及一个USB磁盘, 而主板上面有六个SATA的插槽. 这两个SATA磁盘分别安插在主板上的SATA1, SATA5插槽上, 请问这三个磁盘在Linux中的设备文件名为何？

答: 由于是<u>使用侦测到的顺序来决定设备文件名, 并非与实际插槽代号有关</u>, 因此设备的文件名如下: 

1. SATA1插槽上的文件名: `/dev/sda`
2. SATA5插槽上的文件名: `/dev/sdb`
3. USB磁盘（开机完成后才被系统捉到）: `/dev/sdc`



### 开机流程中的BIOS与UEFI开机检测程序

操作系统会控制所有的硬件并向上层应用程序提供核心功能, 因此计算机就能够认识硬盘内的文件系统, 并进一步读取硬盘内的软件文件与执行.

**问题是, 操作系统也是软件, 那么计算机又是如何认识这个操作系统软件并且执行它的？ 明明开机时计算机中还没有任何软件系统, 那它要如何读取硬盘内的操作系统文件呢？这就得要牵涉到计算机的开机启动程序了！**

目前主要有两种方式: 早期的BIOS和新的UEFI

CMOS是记录各项硬件参数且嵌入在主板上面的储存器, BIOS则是一个写入到主板上的一个固件（固件就是写入到硬件上的一个软件程序）。

#### BIOS搭配MBR/GPT的开机流程

1. 计算机系统会主动执行<u>BIOS程序</u>.

2. BIOS会分析计算机里面有哪些存储设备, 根据用户的设置, 到该硬盘里面区读取第一个扇区的<u>MBR</u>位置.

3. MBR这个仅有446B的硬盘容量里面会放置最基本的<u>开机管理程序(boot loader)</u>, 接下来就是MBR内的开机管理程序的工作了.

4. 开机管理程序加载<u>核心文件</u>

   开机管理程序是操作系统在安装的时候所提供的, 它会认识硬盘内的文件系统格式, 因此能够读取核心文件.

5. 操作系统正常工作

如果分区表是GPT格式, 那么BIOS也能够从LBA0的MBR相容的区块读取第一阶段的开机管理程序码. 能否正常开机取决于boot loader是否能够识别GPT格式, 如果不能识别GPT, 则无法读取操作系统核心文件, 故而开机失败.